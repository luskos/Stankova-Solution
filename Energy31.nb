(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     35378,       1064]
NotebookOptionsPosition[     34754,       1045]
NotebookOutlinePosition[     35191,       1062]
CellTagsIndexPosition[     35148,       1059]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "you", " ", "actually", " ", "want", " ", "to", " ", 
    "play", " ", "with"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "1.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"A", "=", "1.0*^-4"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"w", "=", "0.02"}], ";"}], "           ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"<<", 
      RowBox[{"<<", "two"}]}], " ", "orders", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wider", "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[CurlyEpsilon]", "=", "0.01"}], ";"}], "           ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"radial", " ", "cut"}], "\[Dash]", 
     RowBox[{"off", " ", "to", " ", "avoid", " ", 
      RowBox[{"0", "/", "0"}], " ", "at", " ", "the", " ", "centre"}]}], 
    "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"finite", "\[Dash]", 
     RowBox[{
     "difference", " ", "step", " ", "tied", " ", "to", " ", "the", " ", 
      "width", " ", "of", " ", "the", " ", "bump"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hFD", "=", 
     RowBox[{"w", "/", "25"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Conformal", " ", "factor", " ", "\[CapitalPhi]", " ", 
     RowBox[{"(", 
      RowBox[{"40", "-", 
       RowBox[{
       "digit", " ", "precision", " ", "so", " ", "it", " ", "never", " ", 
        "under"}], "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "flows", " ", "even", " ", "when", " ", "w", " ", "is", " ", "small"}], 
     ")"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "\[CapitalPhi]Safe", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]Safe", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}], ",", 
       RowBox[{"z_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"x", "^", "2"}], "+", 
             RowBox[{"y", "^", "2"}], "+", 
             RowBox[{"z", "^", "2"}]}], "]"}], ",", "\[CurlyEpsilon]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CurlyPhi]", "=", 
           RowBox[{
            RowBox[{"-", "A"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"R0", "/", "r"}]}], ")"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r", "-", "R0"}], ")"}], "^", "2"}], ")"}]}], "/", 
              RowBox[{"w", "^", "2"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"\[CurlyPhi]", ",", "40"}], "]"}], "/.", " ", 
          RowBox[{
           RowBox[{"_", "?", "Negative"}], "->", 
           RowBox[{"-", 
            RowBox[{"10.", "^", 
             RowBox[{"-", "30"}]}]}]}]}]}], "  ", 
        RowBox[{"(*", 
         RowBox[{"keep", " ", "tiny", " ", "tail"}], "*)"}], "]"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Metric", "&"}], " ", "inverse", " ", "metric", " ", 
     RowBox[{"(", 
      RowBox[{"memoised", "\[LongDash]", 
       RowBox[{"speeds", " ", "the", " ", "FD", " ", "loops"}]}], ")"}]}], 
    "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", 
    RowBox[{"g", ",", "gInv"}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}], ",", 
       RowBox[{"z_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f", "=", 
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "f"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "f"}], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"1", "/", "f"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", 
            RowBox[{"1", "/", "f"}]}], "}"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gInv", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}], ",", 
       RowBox[{"z_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"gInv", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", 
        RowBox[{"g", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Finite", "-", 
      RowBox[{
      "difference", " ", "derivative", " ", "of", " ", "\[CapitalPhi]", " ", 
       "only"}]}], "\[Dash]", 
     RowBox[{
      RowBox[{"cheaper", "&"}], " ", "stabler"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d\[CapitalPhi]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "dir_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Delta]", "=", "hFD"}], "}"}], ",", 
       RowBox[{"Switch", "[", 
        RowBox[{"dir", ",", "1", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{
              RowBox[{"x", "+", "\[Delta]"}], ",", "y", ",", "z"}], "]"}], "-", 
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{
              RowBox[{"x", "-", "\[Delta]"}], ",", "y", ",", "z"}], "]"}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Delta]"}], ")"}]}], ",", "2", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{"x", ",", 
              RowBox[{"y", "+", "\[Delta]"}], ",", "z"}], "]"}], "-", 
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{"x", ",", 
              RowBox[{"y", "-", "\[Delta]"}], ",", "z"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Delta]"}], ")"}]}], ",", "3", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"z", "+", "\[Delta]"}]}], "]"}], "-", 
            RowBox[{"\[CapitalPhi]Safe", "[", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"z", "-", "\[Delta]"}]}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Delta]"}], ")"}]}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Einstein", " ", "tensor", " ", "for", " ", "a", "*", "conformally", " ", 
     "flat", "*", "metric", " ", "is", " ", 
     RowBox[{"trivial", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"G_", 
       RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], "=", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", "\[Mu]"}], 
           RowBox[{"\[PartialD]", "\[Nu]\[CapitalPhi]"}]}], "\[Dash]", 
          RowBox[{
           RowBox[{"\[PartialD]", "\[Mu]\[CapitalPhi]"}], " ", 
           RowBox[{"\[PartialD]", "\[Nu]\[CapitalPhi]"}]}]}], ")"}]}], "+", 
       RowBox[{"O", 
        RowBox[{"(", "\[CapitalPhi]\.b2", ")"}], " ", "in", " ", "these", " ",
         "units"}]}]}], ","}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "but", " ", "we", " ", "keep", " ", "the", " ", "full", " ", "numeric", " ",
       "finite"}], "-", 
     RowBox[{"difference", " ", "version", " ", "here"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "Einstein", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Einstein", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}], ",", 
       RowBox[{"z_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", "=", 
          RowBox[{"\[CapitalPhi]Safe", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", "gradPhi"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"gradPhi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"d\[CapitalPhi]", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"Total", "[", 
             RowBox[{"gradPhi", "^", "2"}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"G_tt", "\[RightArrow]", 
             RowBox[{"-", "\[Rho]"}]}], "*)"}], 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"gradPhi", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"G_rr", "\[RightArrow]", 
             RowBox[{"+", "pr"}]}], "*)"}], 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"gradPhi", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"G_\[Theta]\[Theta]", "\[RightArrow]", 
             RowBox[{"+", "p\[Theta]"}]}], "*)"}], 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"gradPhi", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}]}], "         ", 
          RowBox[{"(*", 
           RowBox[{"G_\[Phi]\[Phi]", "\[RightArrow]", 
            RowBox[{"+", "p\[Phi]"}]}], "*)"}], "}"}], "]"}]}]}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Stress", "\[Dash]", 
     RowBox[{
      RowBox[{"energy", " ", "T_", 
       RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", "8"}], "\[Pi]"}], ")"}], " ", "G_", 
       RowBox[{"{", "\[Mu]\[Nu]", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", 
       RowBox[{"y_", "?", "NumericQ"}], ",", 
       RowBox[{"z_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Einstein", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", " ", "\[Pi]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Energy", "-", 
     RowBox[{"condition", " ", "test", " ", "functions"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nullVec", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"timeVec", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NEC", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"nullVec", ".", 
       RowBox[{"T", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ".", "nullVec"}], "//", 
      "Chop"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WEC", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"timeVec", ".", 
       RowBox[{"T", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ".", "timeVec"}], "//", 
      "Chop"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"4", "\[Pi]", " ", 
     RowBox[{"r", "^", "2"}], " ", "\[Rho]", " ", 
     RowBox[{"e", "^", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], "\[CapitalPhi]"}], "}"}]}], " ", "integrand", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Rho]", "="}], " ", "\[Dash]", "T_tt"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"r_", "?", "NumericQ"}], "]"}], ":=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"r", ",", "0", ",", "0"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"sqrtMinusDet", "[", "r_", "]"}], ":=", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"\[CapitalPhi]Safe", "[", 
        RowBox[{"r", ",", "0", ",", "0"}], "]"}]}], "]"}]}], ";"}], "   ", 
   RowBox[{"(*", 
    RowBox[{"analytic", " ", "for", " ", "CF", " ", "metric"}], "*)"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"integrand", "[", 
      RowBox[{"r_", "?", "NumericQ"}], "]"}], ":=", 
     RowBox[{"4", " ", "\[Pi]", " ", 
      RowBox[{"r", "^", "2"}], " ", 
      RowBox[{"\[Rho]", "[", "r", "]"}], " ", 
      RowBox[{"sqrtMinusDet", "[", "r", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"totalExoticEnergy", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"integrand", "[", "r", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "\[CurlyEpsilon]", ",", 
          RowBox[{"3", " ", "R0"}]}], "}"}], ",", 
        RowBox[{"AccuracyGoal", "->", "8"}], ",", 
        RowBox[{"PrecisionGoal", "->", "8"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n\:25ba Total exotic (negative) energy  =  \>\"", ",", 
      "totalExoticEnergy"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Quick", " ", "sanity", " ", "table"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"NEC", "[", 
          RowBox[{"r", ",", "0", ",", "0"}], "]"}], ",", 
         RowBox[{"WEC", "[", 
          RowBox[{"r", ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.05", ",", "0.1", ",", "0.5", ",", "1.0", ",", 
           "2.0"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"TableHeadings", "->", 
      RowBox[{"{", 
       RowBox[{"None", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<r\>\"", 
          ",", "\"\<k\[CenterDot]T\[CenterDot]k  (NEC)\>\"", 
          ",", "\"\<\[Rho]  (WEC)\>\""}], "}"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"7d70c830-668c-db44-be5e-3d3514ca9399"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\:25ba Total exotic (negative) energy  =  \"\>", "\[InvisibleSpace]",
    "4.0691211751234983`*^-199"}],
  SequenceForm[
  "\n\:25ba Total exotic (negative) energy  =  ", 4.0691211751234983`*^-199],
  Editable->False]], "Print",
 CellChangeTimes->{3.959312641336464*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"6a4bc995-f791-2f4f-a871-7a57e8308c6b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"r\"\>",
       HoldForm], 
      TagBox["\<\"k\[CenterDot]T\[CenterDot]k  (NEC)\"\>",
       HoldForm], 
      TagBox["\<\"\[Rho]  (WEC)\"\>",
       HoldForm]},
     {"0.02`", "0", "0"},
     {"0.05`", "0", "0"},
     {"0.1`", "0", "0"},
     {"0.5`", "0", "0"},
     {"1.`", "0", 
      RowBox[{"-", "1.9862575067910624`*^-10"}]},
     {"2.`", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"r", "k\[CenterDot]T\[CenterDot]k  (NEC)", 
       "\[Rho]  (WEC)"}}]]]], "Output",
 CellChangeTimes->{3.959312641341488*^9},
 CellLabel->
  "Out[126]//TableForm=",ExpressionUUID->"fb730d72-6cd9-5a44-b2f3-\
1ea24926e8b0"]
}, Open  ]]
},
WindowSize->{1152, 579.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8ffe6b1b-229f-dd4d-a177-9a37530941cd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 32541, 968, 1379, "Input",ExpressionUUID->"7d70c830-668c-db44-be5e-3d3514ca9399"],
Cell[33120, 992, 428, 10, 39, "Print",ExpressionUUID->"6a4bc995-f791-2f4f-a871-7a57e8308c6b"],
Cell[33551, 1004, 1187, 38, 146, "Output",ExpressionUUID->"fb730d72-6cd9-5a44-b2f3-1ea24926e8b0"]
}, Open  ]]
}
]
*)

